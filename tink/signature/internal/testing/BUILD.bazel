load("@rules_cc//cc:cc_library.bzl", "cc_library")

package(
    default_testonly = 1,
    default_visibility = ["//:__subpackages__"],
)

licenses(["notice"])

cc_library(
    name = "rsa_ssa_pkcs1_test_vectors",
    testonly = 1,
    srcs = ["rsa_ssa_pkcs1_test_vectors.cc"],
    hdrs = ["rsa_ssa_pkcs1_test_vectors.h"],
    include_prefix = "tink/signature/internal/testing",
    deps = [
        ":signature_test_vector",
        "//tink:big_integer",
        "//tink:insecure_secret_key_access",
        "//tink:partial_key_access",
        "//tink:restricted_data",
        "//tink:secret_data",
        "//tink/internal:fips_utils",
        "//tink/internal:util",
        "//tink/signature:rsa_ssa_pkcs1_parameters",
        "//tink/signature:rsa_ssa_pkcs1_private_key",
        "//tink/signature:rsa_ssa_pkcs1_public_key",
        "//tink/util:test_util",
        "@abseil-cpp//absl/log:absl_check",
        "@abseil-cpp//absl/memory",
        "@abseil-cpp//absl/status:statusor",
        "@abseil-cpp//absl/strings",
        "@abseil-cpp//absl/types:optional",
    ],
)

cc_library(
    name = "signature_test_vector",
    testonly = 1,
    hdrs = ["signature_test_vector.h"],
    include_prefix = "tink/signature/internal/testing",
    deps = [
        "//tink/signature:signature_private_key",
        "@abseil-cpp//absl/strings:string_view",
    ],
)

cc_library(
    name = "rsa_ssa_pss_test_vectors",
    testonly = 1,
    srcs = ["rsa_ssa_pss_test_vectors.cc"],
    hdrs = ["rsa_ssa_pss_test_vectors.h"],
    include_prefix = "tink/signature/internal/testing",
    deps = [
        ":signature_test_vector",
        "//tink:big_integer",
        "//tink:insecure_secret_key_access",
        "//tink:partial_key_access",
        "//tink:restricted_big_integer",
        "//tink:restricted_data",
        "//tink:secret_data",
        "//tink/internal:fips_utils",
        "//tink/internal:util",
        "//tink/signature:rsa_ssa_pss_parameters",
        "//tink/signature:rsa_ssa_pss_private_key",
        "//tink/signature:rsa_ssa_pss_public_key",
        "//tink/util:test_util",
        "@abseil-cpp//absl/log:absl_check",
        "@abseil-cpp//absl/memory",
        "@abseil-cpp//absl/status:statusor",
        "@abseil-cpp//absl/strings",
        "@abseil-cpp//absl/types:optional",
    ],
)

cc_library(
    name = "ed25519_test_vectors",
    testonly = 1,
    srcs = ["ed25519_test_vectors.cc"],
    hdrs = ["ed25519_test_vectors.h"],
    include_prefix = "tink/signature/internal/testing",
    deps = [
        ":signature_test_vector",
        "//tink:insecure_secret_key_access",
        "//tink:partial_key_access",
        "//tink:restricted_data",
        "//tink/signature:ed25519_parameters",
        "//tink/signature:ed25519_private_key",
        "//tink/signature:ed25519_public_key",
        "//tink/util:statusor",
        "//tink/util:test_util",
        "@abseil-cpp//absl/log:absl_check",
        "@abseil-cpp//absl/memory",
        "@abseil-cpp//absl/strings",
        "@abseil-cpp//absl/strings:string_view",
        "@abseil-cpp//absl/types:optional",
    ],
)

cc_library(
    name = "ecdsa_test_vectors",
    testonly = 1,
    srcs = ["ecdsa_test_vectors.cc"],
    hdrs = ["ecdsa_test_vectors.h"],
    include_prefix = "tink/signature/internal/testing",
    deps = [
        ":signature_test_vector",
        "//tink:big_integer",
        "//tink:ec_point",
        "//tink:insecure_secret_key_access",
        "//tink:partial_key_access",
        "//tink:restricted_data",
        "//tink/signature:ecdsa_parameters",
        "//tink/signature:ecdsa_private_key",
        "//tink/signature:ecdsa_public_key",
        "//tink/util:test_util",
        "@abseil-cpp//absl/log:absl_check",
        "@abseil-cpp//absl/memory",
        "@abseil-cpp//absl/status:statusor",
        "@abseil-cpp//absl/types:optional",
    ],
)

cc_library(
    name = "ml_dsa_test_vectors",
    testonly = 1,
    srcs = ["ml_dsa_test_vectors.cc"],
    hdrs = ["ml_dsa_test_vectors.h"],
    include_prefix = "tink/signature/internal/testing",
    deps = [
        ":signature_test_vector",
        "//tink:insecure_secret_key_access",
        "//tink:partial_key_access",
        "//tink:restricted_data",
        "//tink/signature:ml_dsa_parameters",
        "//tink/signature:ml_dsa_private_key",
        "//tink/signature:ml_dsa_public_key",
        "//tink/util:statusor",
        "//tink/util:test_util",
        "@abseil-cpp//absl/log:absl_check",
        "@abseil-cpp//absl/memory",
        "@abseil-cpp//absl/strings",
        "@abseil-cpp//absl/types:optional",
    ],
)

cc_library(
    name = "composite_ml_dsa_test_util",
    testonly = 1,
    srcs = ["composite_ml_dsa_test_util.cc"],
    hdrs = ["composite_ml_dsa_test_util.h"],
    include_prefix = "tink/signature/internal/testing",
    deps = [
        "//tink:big_integer",
        "//tink:ec_point",
        "//tink:insecure_secret_key_access_testonly",
        "//tink:partial_key_access",
        "//tink:restricted_big_integer",
        "//tink:restricted_data",
        "//tink/internal:ec_util",
        "//tink/internal:rsa_util",
        "//tink/internal:secret_buffer",
        "//tink/internal:ssl_unique_ptr",
        "//tink/signature:composite_ml_dsa_parameters",
        "//tink/signature:composite_ml_dsa_private_key",
        "//tink/signature:ecdsa_parameters",
        "//tink/signature:ecdsa_private_key",
        "//tink/signature:ecdsa_public_key",
        "//tink/signature:ed25519_parameters",
        "//tink/signature:ed25519_private_key",
        "//tink/signature:ed25519_public_key",
        "//tink/signature:ml_dsa_parameters",
        "//tink/signature:ml_dsa_private_key",
        "//tink/signature:ml_dsa_public_key",
        "//tink/signature:rsa_ssa_pkcs1_parameters",
        "//tink/signature:rsa_ssa_pkcs1_private_key",
        "//tink/signature:rsa_ssa_pkcs1_public_key",
        "//tink/signature:rsa_ssa_pss_parameters",
        "//tink/signature:rsa_ssa_pss_private_key",
        "//tink/signature:rsa_ssa_pss_public_key",
        "//tink/signature:signature_private_key",
        "//tink/subtle:common_enums",
        "//tink/util:secret_data",
        "//tink/util:test_util",
        "@abseil-cpp//absl/log:absl_check",
        "@abseil-cpp//absl/log:absl_log",
        "@abseil-cpp//absl/status",
        "@abseil-cpp//absl/status:statusor",
        "@abseil-cpp//absl/strings:string_view",
        "@abseil-cpp//absl/types:optional",
        "@boringssl//:crypto",
    ],
)

cc_test(
    name = "composite_ml_dsa_test_util_test",
    srcs = ["composite_ml_dsa_test_util_test.cc"],
    deps = [
        ":composite_ml_dsa_test_util",
        "//tink/signature:composite_ml_dsa_parameters",
        "@abseil-cpp//absl/types:optional",
        "@googletest//:gtest_main",
    ],
)
